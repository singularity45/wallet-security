// Refactor contract state machine design
// Fix overflow bug in token calculation
